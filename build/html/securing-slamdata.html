

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Securing SlamData Community Edition &mdash; SlamData 2.5 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="SlamData 2.5 documentation" href="index.html"/>
        <link rel="next" title="Troubleshooting FAQ" href="troubleshooting-faq.html"/>
        <link rel="prev" title="SlamData Tutorial" href="tutorial.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SlamData
          

          
          </a>

          
            
            
              <div class="version">
                2.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="users-guide.html">Users Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">SlamData Tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Securing SlamData Community Edition</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#assumptions">Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#architecture-overview">Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-the-backend">Setting Up The Backend</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#download-and-build-the-backend">Download and Build the Backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configure">Configure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#testing-the-backend">Testing the Backend</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#start-the-core-jar-file">Start the Core jar file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#start-the-web-jar-file">Start the Web jar file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#install-pre-requisites">Install Pre-requisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#download-and-build-slamdata">Download and Build SlamData</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#installing-nginx">Installing Nginx</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#os-x">OS X</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#redhat-centos">Redhat / CentOS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ubuntu-debian">Ubuntu / Debian</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-nginx">Configuring Nginx</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-authentication">Setting up Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nginx-configuration-file">Nginx Configuration File</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting-faq.html">Troubleshooting FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="sql-squared-reference.html">Reference - SQLÂ²</a></li>
<li class="toctree-l1"><a class="reference internal" href="slamdown-reference.html">Reference - SlamDown</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-reference.html">Reference - SlamData API</a></li>
<li class="toctree-l1"><a class="reference internal" href="administration-guide.html">Administration Guide - Community Edition</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">SlamData</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Securing SlamData Community Edition</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/securing-slamdata.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="figure">
<img alt="SlamData Logo" src="_images/white-logo.png" />
</div>
<div class="section" id="securing-slamdata-community-edition">
<h1>Securing SlamData Community Edition<a class="headerlink" href="#securing-slamdata-community-edition" title="Permalink to this headline">Â¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">Â¶</a></h2>
<p>This guide can assist with configuring NGINX (or other proxy service)
and SlamData to limit access based on HTTP authentication and URL paths.</p>
<p><strong>Note:</strong> SlamData Advanced includes LDAP/OAuth authentication, fine
grained authorization and user auditing - all of the security you need
for peace of mind in the enterprise.</p>
<hr class="docutils" />
<p>SlamData is an all-in-one NoSQL visual analytics system. You can get
started right away by simply downloading the software and running it on
your local system, or install it on a dedicated server. There is no need
to follow this guide if you do not need to limit access to SlamData. If
you need to restrict access to the SlamData application to certain
users, then read on!</p>
<p>Watching our <a class="reference external" href="https://www.youtube.com/watch?v=ZCzv8WCVvRM">YouTube video</a>
(~24 minutes) may help as well. The video is based off the instructions in
this guide.</p>
<p>There are several methods of restricting access to SlamData. This guide
focuses on configuring SlamData to run under Nginx providing basic
http authorization, then forwarding requests to the backend either on
the same host or a separate host.</p>
<p>This quick guide does not give detailed instructions on how to setup
firewall rules or configure applications other than SlamData and Nginx.</p>
</div>
<hr class="docutils" />
<div class="section" id="assumptions">
<h2>Assumptions<a class="headerlink" href="#assumptions" title="Permalink to this headline">Â¶</a></h2>
<p>For the example in this quick guide, we&#8217;ll continue with the following
assumptions:</p>
<ul class="simple">
<li>192.168.138.220: IP address of MongoDB host, already running on port
27017</li>
<li>192.168.138.210: IP address of Backend host</li>
<li>192.168.138.200: IP address of Nginx/SlamData UI host</li>
<li>If network security policy dictates, then network communication
between hosts is restricted via ipchains or other firewall mechanism.
This allows simpler Backend and Nginx configuration files.</li>
<li>The reader has at least a basic understanding of JSON formatting and
the Linux OS</li>
<li>Running on Ubuntu 14.04 or similar. If using RedHat, use &#8216;yum&#8217; rather
than &#8216;apt-get&#8217; for software management.</li>
<li>You have version 2.2.1 or newer of SlamData source code.</li>
</ul>
<p>If your IP addresses differ, change as appropriate.</p>
</div>
<hr class="docutils" />
<div class="section" id="architecture-overview">
<h2>Architecture Overview<a class="headerlink" href="#architecture-overview" title="Permalink to this headline">Â¶</a></h2>
<div class="figure" id="id1">
<img alt="Architecture Overview" src="_images/restrict-slamdata.png" />
<p class="caption"><span class="caption-text">Architecture Overview</span></p>
</div>
<p>As can be noted from the above diagram, the network communications path
is straight forward:</p>
<ol class="arabic simple">
<li>A request comes into SlamData running under Nginx.</li>
<li>Nginx authenticates the user via standard http auth.</li>
<li>After appropriate authentication, Nginx allows the user into the
SlamData application, which communicates directly to the Backend&#8217;s
web API.</li>
<li>The backend runs the appropriate tasks on the data source, MongoDB in
this case, and returns the results back upstream, through Nginx to
the client.</li>
</ol>
<p>For increased security, this configuration assumes the reader has setup
appropriate network or OS-level restrictions that will deny access to
requests other than the system upstream from it. For instance, the
MongoDB server should only allow requests to port 27017 from IP
192.168.138.210 (the Backend host). Similarly, the Backend should only
allow requests to port 8080 from IP 192.168.138.200 (the SlamData /
Nginx host). This setup is not covered in this guide and is left to the
reader to implement.</p>
</div>
<hr class="docutils" />
<div class="section" id="setting-up-the-backend">
<h2>Setting Up The Backend<a class="headerlink" href="#setting-up-the-backend" title="Permalink to this headline">Â¶</a></h2>
<p>The first step is to download the Backend and build the source on the
system that will be hosting it.</p>
<div class="section" id="download-and-build-the-backend">
<h3>Download and Build the Backend<a class="headerlink" href="#download-and-build-the-backend" title="Permalink to this headline">Â¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre>$ git clone https://github.com/slamdata/quasar
$ cd quasar
$ ./sbt test
$ ./sbt &#39;project web&#39; oneJar
$ ./sbt &#39;project core&#39; oneJar
</pre></div>
</div>
<p>These commands will download the latest source code, run the test suite,
and build both the Web and Core projects jar files.</p>
</div>
<div class="section" id="configure">
<h3>Configure<a class="headerlink" href="#configure" title="Permalink to this headline">Â¶</a></h3>
<p>Configure the Backend server to connect to MongoDB. Assuming there is a
MongoDB databased called &#8216;testdb&#8217; running on 192.168.138.220, your
configuration file may be called quasar-config.json and look like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
  <span class="s">&quot;mountings&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">&quot;/local&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s">&quot;mongodb&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s">&quot;connectionUri&quot;</span><span class="p">:</span> <span class="s">&quot;mongodb://192.168.138.220/testdb&quot;</span>
          <span class="p">}</span>
      <span class="p">}</span>
  <span class="p">},</span>
  <span class="s">&quot;server&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s">&quot;port&quot;</span><span class="p">:</span> <span class="mi">8080</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For further details on the format of the configuration file, please see
the Backend
<a class="reference external" href="http://slamdata.com/documentation/back-end-manual/#configuration">Configuration</a>
documentation.</p>
</div>
<div class="section" id="testing-the-backend">
<h3>Testing the Backend<a class="headerlink" href="#testing-the-backend" title="Permalink to this headline">Â¶</a></h3>
<div class="section" id="start-the-core-jar-file">
<h4>Start the Core jar file<a class="headerlink" href="#start-the-core-jar-file" title="Permalink to this headline">Â¶</a></h4>
<p>From the Backend server, run the core jar file to verify you have
connectivity and your mounting is correct:</p>
<div class="highlight-python"><div class="highlight"><pre>java -jar ~/quasar/core/target/scala-2.11/core_2.11-2.2.1-SNAPSHOT-one-jar.jar ~/quasar-config.json
</pre></div>
</div>
<p>Once launched, a
<a class="reference external" href="https://en.wikipedia.org/wiki/Readâ€“evalâ€“print_loop">REPL</a> console
will appear representing a virtual file system where each MongoDB
database is a directory, and each database directory contains one or
more MongoDB collections.</p>
<p>Notice how the the OS-like file system commands and SQL commands are
executed directly after the $ prompt:</p>
<div class="highlight-python"><div class="highlight"><pre>ðŸ’ª $ ls
local@
ðŸ’ª $ cd local
ðŸ’ª $ ls
local/
testdb/
ðŸ’ª $ cd testdb
ðŸ’ª $ ls
coll1
ðŸ’ª $ select * from coll1;
Mongo
db.coll1.find();


Query time: 0.0s
 name    | age   | gender  | minor  |
---------|-------|---------|--------|
 Johnny  |  42.0 | male    |  false |
 Jenny   |  27.0 | female  |  false |
 Deb     |  33.0 | female  |  false |
 Billy   |  15.0 | male    |   true |
</pre></div>
</div>
</div>
<div class="section" id="start-the-web-jar-file">
<h4>Start the Web jar file<a class="headerlink" href="#start-the-web-jar-file" title="Permalink to this headline">Â¶</a></h4>
<p>Once you have verified proper connectivity between the Backend and
MongoDB, stop the Core jar file and now start the Web jar file with a
slightly different syntax to point to the configuration file:</p>
<div class="highlight-python"><div class="highlight"><pre>java -jar ~/quasar/web/target/scala-2.11/web_2.11-2.2.1-SNAPSHOT-one-jar.jar -c ~/quasar-config.json
</pre></div>
</div>
<p>Congratulations! You now have two of the three necessary systems up and
running for this configuration.</p>
</div>
</div>
<div class="section" id="install-pre-requisites">
<h3>Install Pre-requisites<a class="headerlink" href="#install-pre-requisites" title="Permalink to this headline">Â¶</a></h3>
<p>You should now be working on the system that will be hosting Nginx and
SlamData. If you do not already have npm or node installed there, do so
first.</p>
<p>On Linux:</p>
<div class="highlight-python"><div class="highlight"><pre>$ sudo apt-get install npm
$ sudo apt-get install nodejs-legacy
</pre></div>
</div>
<p>On Mac:</p>
<div class="highlight-python"><div class="highlight"><pre>$ brew install npm
$ brew install nodejs
</pre></div>
</div>
<p>Once npm is installed, utilize it to install
<a class="reference external" href="http://bower.io/">Bower</a>, <a class="reference external" href="http://gulpjs.com/">Gulp</a> and
<a class="reference external" href="http://www.purescript.org/">PureScript</a>:</p>
<div class="highlight-python"><div class="highlight"><pre>$ npm install bower -g
$ npm install gulp -g
$ npm install purescript -g
</pre></div>
</div>
</div>
<div class="section" id="download-and-build-slamdata">
<h3>Download and Build SlamData<a class="headerlink" href="#download-and-build-slamdata" title="Permalink to this headline">Â¶</a></h3>
<p>Now that npm, node, bower, gulp and PureScript are installed, download
the SlamData source and compile:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git clone https://github.com/slamdata/slamdata
$ cd slamdata
$ bower install
$ npm install
$ gulp
</pre></div>
</div>
<p>When gulp completes, you should have a full application under the
&#8216;public&#8217; directory:</p>
<div class="highlight-python"><div class="highlight"><pre>[/Users/me/slamdata]$ ls public
css           fonts         img           index.html    js            notebook.html
</pre></div>
</div>
<p>It may be safest to copy this directory and place it under a directory
with separate permissions for a more secure environment. Whatever
directory you use will be considered your web root directory in future
steps.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="installing-nginx">
<h2>Installing Nginx<a class="headerlink" href="#installing-nginx" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="os-x">
<h3>OS X<a class="headerlink" href="#os-x" title="Permalink to this headline">Â¶</a></h3>
<p>On OS X systems, consider using <a class="reference external" href="http://brew.sh/">HomeBrew</a> to
install Nginx:</p>
<div class="highlight-python"><div class="highlight"><pre>$ brew install nginx
</pre></div>
</div>
<div class="section" id="redhat-centos">
<h4>Redhat / CentOS<a class="headerlink" href="#redhat-centos" title="Permalink to this headline">Â¶</a></h4>
<p>On RedHat or CentOS systems:</p>
<div class="highlight-python"><div class="highlight"><pre>$ sudo yum install nginx
</pre></div>
</div>
</div>
<div class="section" id="ubuntu-debian">
<h4>Ubuntu / Debian<a class="headerlink" href="#ubuntu-debian" title="Permalink to this headline">Â¶</a></h4>
<p>On Ubuntu or Debian systems:</p>
<div class="highlight-python"><div class="highlight"><pre>$ sudo apt-get install nginx
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuring-nginx">
<h3>Configuring Nginx<a class="headerlink" href="#configuring-nginx" title="Permalink to this headline">Â¶</a></h3>
<p>There are two main reasons we&#8217;ll modify the Nginx configuration file in
this guide:</p>
<ol class="arabic simple">
<li>To force user authentication, thus restricting access to known
individuals</li>
<li>To redirect queries to the Backend engine on another host, thus
limiting the access path to the Backend API to individuals
authenticated with Nginx.</li>
</ol>
<p>This example will use the &#8216;default&#8217; Nginx site configuration. Nginx has
many configuration files and is a versatile tool, please contact your
Nginx application administrator if you have questions, or visit the
Nginx web site.</p>
<p>If Nginx is already running, stop it:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo service nginx stop
</pre></div>
</div>
</div>
<div class="section" id="setting-up-authentication">
<h3>Setting up Authentication<a class="headerlink" href="#setting-up-authentication" title="Permalink to this headline">Â¶</a></h3>
<p>To allow http authentication, we&#8217;ll need to create a file which stores
the names and passwords of allowed individuals. To do this, use the
apache2-utils package which provides those tools:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo apt-get install apache2-utils
</pre></div>
</div>
<p>Now create the htpasswd file we&#8217;ll use to store the encrypted data:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo htpasswd -c /etc/nginx/.htpasswd exampleuser
</pre></div>
</div>
<p>Replace &#8216;exampleuser&#8217; with a real username. You&#8217;ll then be prompted for
a password and verification password.</p>
<p>This creates the file /etc/nginx/.htpasswd which we will reference in
the Nginx configuration file below.</p>
</div>
<div class="section" id="nginx-configuration-file">
<h3>Nginx Configuration File<a class="headerlink" href="#nginx-configuration-file" title="Permalink to this headline">Â¶</a></h3>
<p>Assuming the Nginx site configuration file is located at
/etc/nginx/sites-available/default, replace the contents with the
following code, making adjustments where necessary of course:</p>
<div class="highlight-python"><div class="highlight"><pre>server {
  listen 80 default_server;
  listen [::]:80 default_server ipv6only=on;

  server_name your_server_name;

  client_max_body_size 1024M;

  location / {
    auth_basic &quot;Restricted&quot;;
    auth_basic_user_file /etc/nginx/.htpasswd;
    root /slamdata/public;
    try_files $uri $uri/ @backend;
  }

  location @backend {
    proxy_set_header X-Forwarder-For $proxy_add_x_forwarded_for;
    proxy_set_header Host $http_host;
    proxy_redirect off;
    proxy_pass http://192.168.138.210:8080;
  }
}
</pre></div>
</div>
<p>Pay close attention to the &#8216;root&#8217; directive above. Replace the value
with the web root directory referenced earlier. The configuration above
ensures the following important actions:</p>
<ol class="arabic simple">
<li>Nginx runs on port 80</li>
<li>Enables http authentication (lines beginning with &#8216;auth_basic&#8217;)</li>
<li>Nginx acts as a reverse proxy to the Backend service. This can either
be on a remote host (as indicated above) or your the same host as
Nginx.</li>
</ol>
<p>Save the configuration and start or restart Nginx:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo service nginx restart
</pre></div>
</div>
<p>If your network firewall is setup properly, the Backend should be
shielded from all requests except those coming directly from the Nginx
host. Additionally all requests coming from the Nginx host should only
originate from authenticated users via http authentication. You may test
the SlamData / Nginx HTTP authorization by going to the URL:</p>
<p><code class="docutils literal"><span class="pre">http://192.168.138.200</span></code></p>
<p>You should be immediately prompted for a username and password. Upon
successful authorization you should see the SlamData UI:</p>
<div class="figure" id="id2">
<img alt="After Login" src="_images/after-login.png" />
<p class="caption"><span class="caption-text">After Login</span></p>
</div>
<p>Note that you are sending requests to Nginx (IP .200), which
authenticates a username and then sends the request to the Backend (IP
.210), then returns the results directly to the browser. The browser
itself is not redirected as that would defeat the purpose of securing
with Nginx.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="troubleshooting-faq.html" class="btn btn-neutral float-right" title="Troubleshooting FAQ" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tutorial.html" class="btn btn-neutral" title="SlamData Tutorial" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, SlamData.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.5',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>